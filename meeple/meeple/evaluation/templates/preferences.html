{% extends "base.html" %}
{% load static %}

{% block body %}
<div class="position-relative custom-container zindex-0">
    <div class="position-absolute top-50 start-50 translate-middle negative-padding-bottom zindex-0">
        <img src="{% static 'images/dicesNoback.png' %}" alt="Image" draggable="false"
            style="transform: rotate(31deg);">
    </div>

    <div class="shadow-lg p-5 bg-body rounded rounded-5 position-absolute top-50 start-50 translate-middle border border-dark border-2 w-75 h-100 mb-4"
        style="max-height: 85vh;">
        <h2 class="pb-4 fw-bold">Game preferences
            <i class="bi bi-info-circle" onclick="openNotification()"></i>
            <!-- Icono de información con función de notificación -->
        </h2>
        <h5>Choose the ones that could interest you. At least 4.</h5>
        <div class="scroll-hover w-100" style="max-height: 65vh;">
            <form action="" method="post" class="d-flex flex-column justify-content-center align-items-center w-100">
                {% csrf_token %}

                <div class="row w-100 h-100">
                    <div class="col-xl-4">
                        <div class="rounded-div">
                            <img src="{% static 'images/monopoly.jpg' %}" class="img-fluid rounded sm-maxwidth" draggable="false">
                            <h4>Lorcana - Into the Inklands: Boosted<i class="bi bi-info-circle" onclick="openInformation()"></i></h4>
                            <input type="checkbox" class="changeColorCheckbox">
                        </div>
                    </div>
                    <div class="col-xl-4">
                        <div class="rounded-div">
                            <img src="{% static 'images/monopoly.jpg' %}" class="img-fluid rounded sm-maxwidth" draggable="false">
                            <h4>Lorcana - Into the Inklands: Boosted</h4>
                            <input type="checkbox" class="changeColorCheckbox">
                        </div>
                    </div>
                    <div class="col-xl-4">
                        <div class="rounded-div">
                            <img src="{% static 'images/monopoly.jpg' %}" class="img-fluid rounded sm-maxwidth" draggable="false">
                            <h4>Lorcana - Into the Inklands: Boosted</h4>
                            <input type="checkbox" class="changeColorCheckbox">
                        </div>
                    </div>
                    <div class="col-xl-4">
                        <div class="rounded-div">
                            <img src="{% static 'images/monopoly.jpg' %}" class="img-fluid rounded sm-maxwidth" draggable="false">
                            <h4>Lorcana - Into the Inklands: Boosted</h4>
                            <input type="checkbox" class="changeColorCheckbox">
                        </div>
                    </div>
                    <div class="col-xl-4">
                        <div class="rounded-div">
                            <img src="{% static 'images/monopoly.jpg' %}" class="img-fluid rounded sm-maxwidth" draggable="false">
                            <h4>Lorcana - Into the Inklands: Boosted</h4>
                            <input type="checkbox" class="changeColorCheckbox">
                        </div>
                    </div>
                </div>

                <button type="submit" class="btn btn-primary rounded-pill btn-terracota w-50" id="submitButton" style="position: sticky; bottom: 0px;"
                    disabled>Choose preferences</button>
            </form>
        </div>
    </div>

    <div id="infoGame" class="modal information position-absolute top-50 start-50 translate-middle text-start">
        <div class="d-flex justify-content-center align-items-center" style="height: 100vh;">
            <div class="position-relative info-content p-5 border-1 m-auto">
                <span class="close" onclick="closeInformation()">&times;</span>
    
                <div class="row">
                    <div class="col-6 col-md-4">
                        <img src="{% static 'images/monopoly.jpg' %}" class="img-fluid rounded" draggable="false">
                    </div>
                    <div class="col-12 col-md-8">
                        <h2>Lorcana - Into the Inklands: Boosted</h2>
                        <p>Familiar, for 2-6 players, books, tv, medium difficulty, english</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 ">
                        <p>Lorcana - Into the Inklands: Booster is an expansion to the Lorcana collectible card game. Each pack contains 12 random cards consisting of: 6 common cards, 3 unusual cards, 2 rare or legendary cards and 1 shiny or foil card (random rarity level).</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="myModal" class="modal position-absolute top-50 start-50 translate-middle">
        <div class="modal-content">
            <span class="close" onclick="closeNotification()">&times;</span>
            <h2>Preferences page information</h2>
            <p>¡Click on titles to see more information about the table games!</p>
        </div>
    </div>

</div>

<script>
    // Uso de javascript en vez de :has() porque no podemos asegurar
    // el uso de navegadores modernos
    const checkboxes = document.querySelectorAll('.changeColorCheckbox');
    let minimumFour = 0;

    // Recorrer cada checkbox y agregarle un evento de escucha
    checkboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function () {
            // Obtener el contenedor padre del checkbox
            const container = this.closest('.rounded-div');

            // Verificar si el checkbox está marcado o desmarcado
            if (this.checked) {
                container.classList.add('checked');  // Añadir la clase 'checked' si está marcado
                minimumFour += 1;
            } else {
                container.classList.remove('checked');  // Remover la clase 'checked' si está desmarcado
                minimumFour -= 1;
            }

            // Deshabilitar o habilitar el botón de submit
            document.getElementById('submitButton').disabled = (minimumFour < 4);
        });
    });

    // Función para abrir el modal
    function openNotification() {
        document.getElementById("myModal").style.display = "block";
    }

    // Función para abrir la ventana de información del juego
    function openInformation() {
        document.getElementById("infoGame").style.display = "block";
    }

    // Función para cerrar el modal
    function closeNotification() {
        document.getElementById("myModal").style.display = "none";
    }

    // Función para cerrar la ventana de información del juego
    function closeInformation() {
        document.getElementById("infoGame").style.display = "none";
    }

    // Cerrar el modal si se hace clic fuera de él
    window.onclick = function (event) {
        var modal = document.getElementById("myModal");
        var info = document.getElementById("infoGame");
        if (event.target == modal) {
            closeNotification();
        }
        if (event.target == info) {
            closeInformation();

        }
    }
</script>

{% endblock body %}